{
  "entities": {
    "Publisher": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Publisher",
      "type": "object",
      "description": "Represents a publisher within the KonimPay system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Publisher entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the publisher."
        },
        "contactName": {
          "type": "string",
          "description": "Contact person's name at the publisher."
        },
        "email": {
          "type": "string",
          "description": "Email address of the publisher.",
          "format": "email"
        },
        "phone": {
          "type": "string",
          "description": "Phone number of the publisher."
        },
        "paymentMethod": {
          "type": "string",
          "description": "Preferred payment method of the publisher (e.g., bank transfer, PayPal)."
        },
        "paymentDetails": {
          "type": "string",
          "description": "Payment details of the publisher, such as bank account number or PayPal email."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the publisher was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "paymentMethod",
        "paymentDetails"
      ]
    },
    "Offer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Offer",
      "type": "object",
      "description": "Represents an advertising offer or campaign.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Offer entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the offer or campaign."
        },
        "platform": {
          "type": "string",
          "description": "Platform on which the offer is running (e.g., Google Ads, Facebook Ads)."
        },
        "startDate": {
          "type": "string",
          "description": "Start date of the offer.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "End date of the offer.",
          "format": "date-time"
        },
        "payout": {
          "type": "number",
          "description": "Payout amount for the offer."
        },
        "currency": {
          "type": "string",
          "description": "Currency of the payout amount."
        },
        "publisherId": {
          "type": "string",
          "description": "Reference to Publisher. (Relationship: Publisher 1:N Offer)"
        }
      },
      "required": [
        "id",
        "name",
        "platform",
        "startDate",
        "endDate",
        "payout",
        "currency",
        "publisherId"
      ]
    },
    "Payment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Payment",
      "type": "object",
      "description": "Represents a payment made to a publisher.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Payment entity."
        },
        "publisherId": {
          "type": "string",
          "description": "Reference to Publisher. (Relationship: Publisher 1:N Payment)"
        },
        "amount": {
          "type": "number",
          "description": "Amount paid to the publisher."
        },
        "currency": {
          "type": "string",
          "description": "Currency of the payment amount."
        },
        "paymentDate": {
          "type": "string",
          "description": "Date when the payment was made.",
          "format": "date-time"
        },
        "paymentMethod": {
          "type": "string",
          "description": "Method used for the payment (e.g., bank transfer, PayPal)."
        },
        "receiptId": {
          "type": "string",
          "description": "Reference to Receipt. (Relationship: Receipt 1:1 Payment)"
        },
        "notes": {
          "type": "string",
          "description": "Any notes related to this payment."
        }
      },
      "required": [
        "id",
        "publisherId",
        "amount",
        "currency",
        "paymentDate",
        "paymentMethod"
      ]
    },
    "Receipt": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Receipt",
      "type": "object",
      "description": "Represents a payment receipt.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Receipt entity."
        },
        "filename": {
          "type": "string",
          "description": "Name of the receipt file."
        },
        "fileType": {
          "type": "string",
          "description": "Type of the receipt file (e.g., PDF, JPG)."
        },
        "fileSize": {
          "type": "number",
          "description": "Size of the receipt file in bytes."
        },
        "uploadDate": {
          "type": "string",
          "description": "Date when the receipt was uploaded.",
          "format": "date-time"
        },
        "filePath": {
          "type": "string",
          "description": "Path to the receipt file on the server."
        }
      },
      "required": [
        "id",
        "filename",
        "fileType",
        "fileSize",
        "uploadDate",
        "filePath"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/publishers/{publisherId}",
        "definition": {
          "entityName": "Publisher",
          "schema": {
            "$ref": "#/backend/entities/Publisher"
          },
          "description": "Stores publisher information. Includes the publisherId as a document ID.",
          "params": [
            {
              "name": "publisherId",
              "description": "Unique identifier for the publisher."
            }
          ]
        }
      },
      {
        "path": "/publishers/{publisherId}/offers/{offerId}",
        "definition": {
          "entityName": "Offer",
          "schema": {
            "$ref": "#/backend/entities/Offer"
          },
          "description": "Stores offers related to a specific publisher. Uses publisherId to establish the relationship.",
          "params": [
            {
              "name": "publisherId",
              "description": "Unique identifier for the publisher."
            },
            {
              "name": "offerId",
              "description": "Unique identifier for the offer."
            }
          ]
        }
      },
      {
        "path": "/publishers/{publisherId}/payments/{paymentId}",
        "definition": {
          "entityName": "Payment",
          "schema": {
            "$ref": "#/backend/entities/Payment"
          },
          "description": "Stores payment information for each publisher. Uses publisherId to establish the relationship.",
          "params": [
            {
              "name": "publisherId",
              "description": "Unique identifier for the publisher."
            },
            {
              "name": "paymentId",
              "description": "Unique identifier for the payment."
            }
          ]
        }
      },
      {
        "path": "/receipts/{receiptId}",
        "definition": {
          "entityName": "Receipt",
          "schema": {
            "$ref": "#/backend/entities/Receipt"
          },
          "description": "Stores payment receipts. Includes the receiptId as a document ID.",
          "params": [
            {
              "name": "receiptId",
              "description": "Unique identifier for the receipt."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the KonimPay application, focusing on managing publishers, offers, payments, and receipts. The structure prioritizes Authorization Independence by avoiding hierarchical authorization dependencies (`get()`). All collections are designed to have homogeneous security requirements.\n\n**Authorization Independence and QAPs (Rules are not Filters):**\n\n*   The data structure uses explicit path-based ownership and segregation of data to enforce clear authorization boundaries. For example, publisher data is stored directly under the `/publishers` collection.\n*   This structure ensures that list operations are secure because rules can validate based on the current document's fields without needing to fetch data from parent documents or related collections.\n\n**Collection Structure:**\n\n*   **/publishers:** Stores publisher information.\n*   **/publishers/{publisherId}/offers:** Stores offers related to each publisher. The `publisherId` field in the offer document establishes the relationship. This enables efficient querying of offers for a specific publisher.\n*   **/publishers/{publisherId}/payments:** Stores payment information for each publisher.\n*   **/receipts/{receiptId}:** Stores receipts. Includes the `publisherId` field to link the receipt to a specific publisher."
  }
}